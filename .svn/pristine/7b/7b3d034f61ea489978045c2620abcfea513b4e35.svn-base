$(function(){

    /* 订单筛选交互演示用*/
    $('#order_tabs a').click(function () {
        $that = $(this);
        $that.parent().addClass('active');
        $that.parent().siblings().removeClass('active');
        //var _cla = $that.attr("data-type")
        //
        //$("#statusflag").val($(".flagli .active").find("a").attr("data-type"));
        //submitOrder();
    });
    /* 下面是表单里面的日期时间选择相关的 */
    $('.form_datetime').datetimepicker({
        format: 'yyyy-mm-dd hh:ii:00',
        weekStart : 1,
        autoclose : true,
        language : 'zh-CN',
        pickerPosition : 'bottom-left',
        todayBtn : true,
        viewSelect : 'hour'
    });
    $('.form_date').datetimepicker({
        format : 'yyyy-mm-dd',
        weekStart : 1,
        autoclose : true,
        language : 'zh-CN',
        pickerPosition : 'bottom-left',
        minView : 2,
        todayBtn : true
    });
    /*下面是时间选择器开始时间不能大于结束时间设置  START*/
    var startTime = $("#startTime").val();
    var endTime = $("#endTime").val();
    $('#endpicker').datetimepicker('setStartDate', startTime);
    $('#startpicker').datetimepicker('setEndDate', endTime);
    $('#endpicker')
        .datetimepicker()
        .on('show', function (ev) {
            startTime = $("#startTime").val();
            endTime = $("#endTime").val();
            $('#endpicker').datetimepicker('setStartDate', startTime);
            $('#startpicker').datetimepicker('setEndDate', endTime);
        });
    $('#startpicker')
        .datetimepicker()
        .on('show', function (ev) {
            endTime = $("#endTime").val();
            startTime = $("#startTime").val();
            $('#startpicker').datetimepicker('setEndDate', endTime);
            $('#endpicker').datetimepicker('setStartDate', startTime);
        });



})
/*查看详细*/
function fnOpen(oId) {
    //$.ajax({
    //    type : "POST",
    //    url:"orderdetailajax.htm",
    //    data : "orderId=" + oId,
    //    success:function(data){
            //清空列表
            //$("#ordergoods").html("");
            //$("#pageorder").html("");
            //$("#orderLog").html("");
            ////退款日志
            //$("#ordertk").html("");
            //if(data!="" && data!= null && data != undefined){
            //    /*等的详情*/
            //    //订单详细信息
            //    var order = data.order;
            //    var relations = data.relations;
            //    if(order!= null){
            //        var status = addstatusstr('已下单',order.createTime,1,'active');
            //        if(order.payTime != null){
            //            status += addstatusstr('已付款',order.payTime,2,'active');
            //        }else{
            //            status += addstatusstr('已付款',null,2,'');
            //        }
            //        if(order.sendExpressTime != null){
            //            status += addstatusstr('已发货',order.sendExpressTime,3,'active');
            //        }else{
            //            status += addstatusstr('已发货',null,3,'');
            //        }
            //        if(order.getGoodsTime != null){
            //            status += addstatusstr('已完成',order.getGoodsTime,4,'active');
            //        }else{
            //            status += addstatusstr('已完成',null,4,'');
            //        }
            //        $("#detailorderCodeNo").html("订单号："+notNull(order.orderCode));
            //        $("#detailorderCode").html("订单编号："+notNull(order.orderCode));
            //        $("#detailcreateTime").html("下单时间："+timeObject(order.createTime));
            //        if(order.orderCancelTime == null) {
            //            $("#detailorederRetime").html('');
            //        }else{
            //            $("#detailorederRetime").html("订单取消时间："+timeObject(order.orderCancelTime));
            //        }
            //        //判断状态
            //        if(order.orderStatus == '0'){
            //            $("#detailorderStatus").html("未付款");
            //        }else if(order.orderStatus == '1'){
            //            $("#detailorderStatus").html("已付款未发货");
            //        }else if(order.orderStatus == '2'){
            //            $("#detailorderStatus").html("已发货");
            //        }else if(order.orderStatus == '3'){
            //            $("#detailorderStatus").html("已完成");
            //        }else if(order.orderStatus == '4'){
            //            $("#detailorderStatus").html("已取消");
            //        }else if(order.orderStatus == '14'){
            //            $("#detailorderStatus").html("退单审核中");
            //        }else if(order.orderStatus == '8'){
            //            $("#detailorderStatus").html("同意退货");
            //        }else if(order.orderStatus == '9'){
            //            $("#detailorderStatus").html("拒绝退货");
            //        }else if(order.orderStatus == '10'){
            //            $("#detailorderStatus").html("待商家收货");
            //        }else if(order.orderStatus == '11'){
            //            $("#detailorderStatus").html("退单结束");
            //        }else if(order.orderStatus == '15'){
            //            $("#detailorderStatus").html("退款审核中");
            //        }else if(order.orderStatus == '13'){
            //            $("#detailorderStatus").html("拒绝退款");
            //        }else if(order.orderStatus == '14'){
            //            $("#detailorderStatus").html("已提交退货审核");
            //        }else if(order.orderStatus == '16'){
            //            $("#detailorderStatus").html("商家收货失败");
            //        }else if(order.orderStatus == '17'){
            //            $("#detailorderStatus").html("已退款");
            //        }else if(order.orderStatus == '18'){
            //            $("#detailorderStatus").html("退款成功");
            //        }
            //        $("#status").html(status);
            //        $("#detailcouponNo").html("使用优惠券："+notNull(order.couponNo));
            //        $("#detailorderOldPrice").html("订单原始金额："+order.orderOldPrice.toFixed(2));
            //        $("#detailorderPrePrice").html("订单优惠金额："+order.orderPrePrice.toFixed(2));
            //        $("#detailorderPrice").html(order.orderPrice.toFixed(2));
            //        if(order.orderIntegral == null){
            //            $("#detailorderIntegral").html("订单使用积分：0");
            //        }else{
            //            $("#detailorderIntegral").html("订单使用积分："+order.orderIntegral);
            //        }
            //        if(order.orderCancelRemark == null){
            //            $("#detailorederRemark").html("");
            //        }else{
            //            $("#detailorederRemark").html("取消订单原因："+order.orderCancelRemark);
            //        }
            //
            //        //物流信息
            //        var str = ""
            //        var count = 0;
            //        for(var i=0;i<relations.length;i++){
            //            count++;
            //            str+="<p>包裹["+count+"]</p>";
            //            str+="<div class='col-sm-12'><p>物流公司："+relations[i].expressName+"</p></div>"
            //            str+="<div class='col-sm-12'><p>物流单号："+relations[i].expressNo+"</p></div>"
            //        }
            //
            //        $("#relations").html(str);
            //        if(order.orderExpress != null){
            //            if(order.orderExpress.expressTypeId==0){
            //                $("#detailorderExpress").html("配送方式：快递配送");
            //            }else if(order.orderExpress.expressTypeId==1){
            //                $("#detailorderExpress").html("配送方式：上门自提");
            //            }
            //        }
            //        if(order.invoiceType =="0"){
            //            var invoicestr = '<div class="col-sm-12">'+
            //                '<p>发票类型：不需要发票</p>'+
            //                '</div>'+
            //                '<div class="col-sm-12">';
            //            if(order.orderLinePay=='1'){
            //                invoicestr+='<p>支付类型：在线支付</p>';
            //            }else if(order.orderLinePay=='0'){
            //                invoicestr+='<p>支付类型：货到付款</p>';
            //            }
            //            invoicestr +='</div>';
            //            $("#invoiceType").html(invoicestr);
            //        }else if(order.invoiceType =="1"){
            //            var invoicestr = '<div class="col-sm-12">'+
            //                '<p>发票类型：普通发票</p>'+
            //                '</div>'+
            //                '<div class="col-sm-12">'+
            //                '<p>发票抬头：'+notNull(order.invoiceTitle)+'</p>'+
            //                '</div>'+
            //                '<div class="col-sm-12">'+
            //                '<p>发票内容：'+notNull(order.invoiceContent)+'</p>'+
            //                '</div>'+
            //                '<div class="col-sm-12">';
            //            if(order.orderLinePay=='1'){
            //                invoicestr+='<p>支付类型：在线支付</p>';
            //
            //            }else if(order.orderLinePay=='0'){
            //                invoicestr+='<p>支付类型：货到付款</p>';
            //            }
            //
            //            invoicestr +='</div>';
            //            $("#invoiceType").html(invoicestr);
            //        }
            //
            //        $("#detailexpressPrice").html("运费："+order.expressPrice.toFixed(2));
            //
            //        //收货信息
            //        $("#detailshippingaddress").html("收货地址："+notNull(order.shippingProvince)+notNull(order.shippingCity)+notNull(order.shippingCounty));
            //        $("#detailaddress").html("详细地址："+notNull(order.shippingAddress));
            //        $("#detailshippingPerson").html("收货人："+notNull(order.shippingPerson));
            //        $("#detailshippingPhone").html("联系电话："+notNull(order.shippingPhone));
            //        $("#detailshippingMobile").html("手机："+notNull(order.shippingMobile));
            //        $("#detailshippingPostcode").html("邮编："+notNull(order.shippingPostcode));
            //        $("#detailcustomerRemark").html("客户留言："+notNull(order.customerRemark));
            //
            //        //卖家备注
            //        $("#detailsellerRemark").html("卖家备注："+notNull(order.sellerRemark));
            //        /*订单商品信息*/
            //
            //        var str ="";
            //        $.each(order.orderGoodsList,function(idx,item){
            //            str+='<tr id="goodsnum'+idx+'" class="">';
            //            str +='<td><div class="data_item"><img alt="" src="'+notNull(item.goodsProductVo.goodsInfoImgId)+'" height="50" >';
            //            str += '<p>'+notNull(item.goodsProductVo.goodsInfoName)+'</p></div>';
            //            str += '</td>';
            //            str+='<td>'+item.goodsInfoOldPrice.toFixed(2)+'</td>';
            //            str+='<td>'+item.goodsInfoNum+'</td>';
            //            if(item.goodsProductReleSpecVoList!=null) {
            //                str += '<td>';
            //                for(var s = 0;s<item.goodsProductReleSpecVoList.length;s++){
            //                    str+=item.goodsProductReleSpecVoList[s].spec.specName+':'+item.goodsProductReleSpecVoList[s].goodsSpecDetail.specDetailName
            //                }
            //                str += '</td>';
            //            }
            //
            //            str +='<td>'+item.goodsInfoPrice.toFixed(2);
            //            str +='</td><td>'+item.goodsInfoSumPrice.toFixed(2);
            //            str =='</td></tr>';
            //        });
            //        $("#ordergoods").html(str);
            //    }
            //}
            $('#orderDetails').modal('show');
    //    }
    //});
}
//拼接订单状态显示
function addstatusstr(str,time,num,cla){
    if(time != null){
        return '<li class="'+cla+'">'+
            '<p class="name">'+str+'</p>'+
            '<p class="bar"><i>'+num+'</i></p>'+
            '<p class="time">'+timeObject(time)+'</p>'+
            '</li>';
    }else{
        return '<li class="'+cla+'">'+
            '<p class="name">'+str+'</p>'+
            '<p class="bar"><i>'+num+'</i></p>'+
            '<p class="time"></p>'+
            '</li>';
    }

}
